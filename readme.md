Тестовое задание Python

Инструкция

1. Задание

    Необходимо разработать скрипт на языке Python 3, который будет выполнять следующие функции:

    - Получать данные с документа при помощи Google API, сделанного в [Google Sheets](https://docs.google.com/spreadsheets/d/1f-qZEX1k_3nj5cahOzntYAnvO4ignbyesVO7yuBdv_g/edit) (необходимо копировать в свой Google аккаунт и выдать самому себе права).
    - Данные должны добавляться в БД, в том же виде, что и в файле –источнике, с добавлением колонки «стоимость в руб.»
    
        a. Необходимо создать DB самостоятельно, СУБД на основе PostgreSQL.
    
        b. Данные для перевода $ в рубли необходимо получать по курсу [ЦБ РФ](https://www.cbr.ru/development/SXML/).
    
    - Скрипт работает постоянно для обеспечения обновления данных в онлайн режиме (необходимо учитывать, что строки в Google Sheets таблицу могут удаляться, добавляться и изменяться).



2. Реализация задания

    - Задание реализовано в виде одностраничного веб-приложения на основе Flask с использованием шаблонизатора Jinja 
    URL: http://127.0.0.1:5000/order_data
    - Приложение и БД PostgreSQL упакованы в контейнеры Docker в Compose
    - Также в композе есть удобный сервис для мониторинга за БД Adminer доступный по http://[::]:8080/
    - Заполнение БД начальными данными происходит при запуске приложения
    - Обновление базы данных в соответствии с таблицей Google Sheets происходит каждые 10 секунд
    - Каждые 24 часа происходит обновление колонки БД price_ruble в соответствии с курсом доллара
    - Для обновления данных в таблицах на веб-странице необходимо обновить страницу через 10 секунд после внесения изменений в таблицу Google Sheets
    - Для корректной работы скрипта, данные в таблице Google Sheets в колонке "№" должны быть уникальны и отсортированы по возрастанию
    - Строки таблицы Google Sheets должны быть заполнены полностью, а также в верном формате, в соответствии с форматом столбцов, иначе данные в таблице на веб-странице не отобразятся



3. Ссылка на мою таблицу Google Sheet
    https://docs.google.com/spreadsheets/d/1NMiT_H6LMGfMy6AxNyxRRZxp_kGLrpA4OWsFDIU4er8/edit#gid=0



4. Запуск приложения

    - должен быть установлен Docker

    - пример установки Docker для Mac:
        https://www.cprime.com/resources/blog/docker-for-mac-with-homebrew-a-step-by-step-tutorial/

    - комманда для запуска приложения в терминале Mac:
        docker-compose up -d --build

    - URL веб-страницы с реализацией:
        http://127.0.0.1:5000/order_data



5. Структура приложения

    TEST_CANAL/ - основная папка проекта

        TEST_CANAL/project - папка проекта с основными папками и файлами .py
            TEST_CANAL/project/static - папка с файлом изображения
            TEST_CANAL/project/templates - папка с шаблоном HTML
            TEST_CANAL/project/__init__.py  - файл инициализации пакета приложения с объектами приложения и БД   
            TEST_CANAL/project/functions.py - файл с определяемыми функциями приложения
            TEST_CANAL/project/models.py - модель данных
            TEST_CANAL/project/views.py - функции-обработчики эндпоинтов
        
        manage.py - настройка запуска приложения

        docker-entrypoint.sh - файл определяющий команды терминала для запуска приложения

        _.dev/yml/md/txt - прочие файлы(Докер,зависимости и т.д)


6. Нюансы

    В какой-то момент планировщик расписаний APScheduler может выдать исключение, пока не нашел в чем проблема.
    В таком случае нужно перезапустить приложение: 
        опустить контейнеры командой: docker-compose down -v
        и снова запустить командой: docker-compose up --build

    Скрины работающего приложения прилагаю:

![Image alt](https://github.com/igo-mo-t/test_canal/raw/v1/image/im2.png)
![Image alt](https://github.com/igo-mo-t/test_canal/raw/v1/image/im.png)